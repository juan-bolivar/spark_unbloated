---
- name: spark installation
  hosts: all
  tasks:

  - name: Creating user 
    user:
      name:  ansible
      shell: /bin/bash
      groups: sudo 
      append: yes
      state: present
      create_home: True 

  - name: installing java
    package: 
      name: openjdk-8-jre-headless
      state: present
      update_cache: yes 
  - name: installing scala
    package:
      name: scala
      state: present

  - name: install unzip
    package:
      name: unzip
      state: present

  - name: downloading spark
    get_url: 
      url:  'https://downloads.apache.org/spark/spark-3.1.1/spark-3.1.1-bin-hadoop2.7.tgz'
      dest: ~/spark.tgz
      force: yes

  - name: creating archive
    file:
      path: /usr/local/spark
      state: directory
      force: yes
  - name: unarchive spark
    command: 'tar xvf ~/spark.tgz'
    tags: unarchive

  - name: moving files
    copy: 
      remote_src: True
      src: spark-3.1.1-bin-hadoop2.7
      dest: /usr/local/spark
  - name: profile spark
    command: "echo 'export PATH=/usr/local/spark/bin:$PATH' >> ~/.profile ; source ~/.profile"


     
    


     
    
